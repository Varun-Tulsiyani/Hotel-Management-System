#include "ReservationSystem.h"
#include <iostream>
#include <fstream>
#include <sstream>
using namespace std;
void ReservationSystem::cancelReservation() {
    auto rooms = getRooms();
    auto &bookedRooms = rooms.first;

    if (bookedRooms.empty()) {
        cout<<"No booked rooms to cancel." <<endl;
        return;
    }

    std::cout << "Booked Rooms:" << std::endl;
    for (const auto &room : bookedRooms) {
        std::cout << "Room Number: " << room.getRoomNumber() << ", Type: " << room.getRoomType()
                  << ", Customer Name: " << room.getCustomerName() << endl;
    }

    int roomNumber;
    cout<< "Enter room number to cancel reservation: ";
    cin >> roomNumber;

    for (auto &room : bookedRooms) {
        if (room.getRoomNumber() == roomNumber) {
            room.releaseRoom();
            break;
        }
    }


    std::ofstream outFile("../room.txt");
    for (const auto &room : rooms.first) {
        outFile << room.getRoomNumber() << ',' << room.getRoomType() << ',' << room.getPricePerNight() << ','
                << room.getIsAvailable() << ',' << room.getCustomerName() << ',' << room.getCheckInDate() << ','
                << room.getCheckOutDate() << '\n';
    }
    outFile.close();

   cout<< "Reservation canceled successfully." << std::endl;
}
